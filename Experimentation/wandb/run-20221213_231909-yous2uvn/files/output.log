
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
c:\Users\andre\AppData\Local\Programs\Python\Python39\lib\site-packages\transformers\data\datasets\language_modeling.py:54: FutureWarning: This dataset will be removed from the library soon, preprocessing should be handled with the ðŸ¤— Datasets library. You can have a look at this example script for pointers: https://github.com/huggingface/transformers/blob/main/examples/pytorch/language-modeling/run_mlm.py
  warnings.warn(
Token indices sequence length is longer than the specified maximum sequence length for this model (3919273 > 1024). Running this sequence through the model will result in indexing errors
env: WANDB_PROJECT=tweet_analysis
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
c:\Users\andre\AppData\Local\Programs\Python\Python39\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
Could not locate the tokenizer configuration file, will try to use the model config instead.
loading configuration file config.json from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\config.json
Model config GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.26.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}
loading file vocab.json from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\vocab.json
loading file merges.txt from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\merges.txt
loading file tokenizer.json from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\tokenizer.json
loading file added_tokens.json from cache at None
loading file special_tokens_map.json from cache at None
loading file tokenizer_config.json from cache at None
loading configuration file config.json from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\config.json
Model config GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.26.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}
loading configuration file config.json from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\config.json
Model config GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.26.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}
loading weights file pytorch_model.bin from cache at C:\Users\andre/.cache\huggingface\hub\models--gpt2\snapshots\f27b190eeac4c2302d24068eabf5e9d6044389ae\pytorch_model.bin
All model checkpoint weights were used when initializing GPT2LMHeadModel.
All the weights of GPT2LMHeadModel were initialized from the model checkpoint at gpt2.
If your task is similar to the task the model of the checkpoint was trained on, you can already use GPT2LMHeadModel for predictions without further training.
c:\Users\andre\AppData\Local\Programs\Python\Python39\lib\site-packages\transformers\data\datasets\language_modeling.py:54: FutureWarning: This dataset will be removed from the library soon, preprocessing should be handled with the ðŸ¤— Datasets library. You can have a look at this example script for pointers: https://github.com/huggingface/transformers/blob/main/examples/pytorch/language-modeling/run_mlm.py
  warnings.warn(
Creating features from dataset file at data/special_token_versions/textfiles
Token indices sequence length is longer than the specified maximum sequence length for this model (2556841 > 1024). Running this sequence through the model will result in indexing errors
env: WANDB_PROJECT=tweet_analysis
Saving features into cached file data/special_token_versions/textfiles\cached_lm_GPT2TokenizerFast_1024_all_data.txt [took 0.060 s]
22246
Tue Dec 13 23:29:59 2022
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 526.98       Driver Version: 526.98       CUDA Version: 12.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name            TCC/WDDM | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA GeForce ... WDDM  | 00000000:01:00.0 Off |                  N/A |
| N/A   57C    P8    N/A /  N/A |    184MiB /  2048MiB |     21%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A     43840    C+G   ...icrosoft VS Code\Code.exe    N/A      |
+-----------------------------------------------------------------------------+
PyTorch: setting up devices
c:\Users\andre\AppData\Local\Programs\Python\Python39\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 2496
  Num Epochs = 3
  Instantaneous batch size per device = 1
  Total train batch size (w. parallel, distributed & accumulation) = 1
  Gradient Accumulation steps = 1
  Total optimization steps = 7488
  Number of trainable parameters = 141521664
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
{'loss': 51.805, 'learning_rate': 0.00013719864155118674, 'epoch': 0.0}
Collecting git+https://github.com/huggingface/transformers
  Cloning https://github.com/huggingface/transformers to c:\users\andre\appdata\local\temp\pip-req-build-dcj1apwe
  Resolved https://github.com/huggingface/transformers to commit d994473b05a83ea398d9f10ca458855df095e22d
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (0.12.1)
Requirement already satisfied: requests in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (2.28.1)
Requirement already satisfied: regex!=2019.12.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (2022.10.31)
Requirement already satisfied: numpy>=1.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (1.23.5)
Requirement already satisfied: pyyaml>=5.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (6.0)
Requirement already satisfied: filelock in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (3.8.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.10.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (0.11.1)
Requirement already satisfied: tqdm>=4.27 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (4.64.1)
Requirement already satisfied: packaging>=20.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from transformers==4.26.0.dev0) (21.3)
Requirement already satisfied: typing-extensions>=3.7.4.3 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from huggingface-hub<1.0,>=0.10.0->transformers==4.26.0.dev0) (4.4.0)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from packaging>=20.0->transformers==4.26.0.dev0) (3.0.9)
Requirement already satisfied: colorama in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from tqdm>=4.27->transformers==4.26.0.dev0) (0.4.6)
Requirement already satisfied: charset-normalizer<3,>=2 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests->transformers==4.26.0.dev0) (2.1.1)
Requirement already satisfied: certifi>=2017.4.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests->transformers==4.26.0.dev0) (2022.9.24)
Requirement already satisfied: idna<4,>=2.5 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests->transformers==4.26.0.dev0) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests->transformers==4.26.0.dev0) (1.26.12)
  Running command git clone --filter=blob:none --quiet https://github.com/huggingface/transformers 'C:\Users\andre\AppData\Local\Temp\pip-req-build-dcj1apwe'
Requirement already satisfied: wandb in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (0.13.6)
Requirement already satisfied: shortuuid>=0.5.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (1.0.11)
Requirement already satisfied: psutil>=5.0.0 in c:\users\andre\appdata\roaming\python\python39\site-packages (from wandb) (5.9.4)
Requirement already satisfied: promise<3,>=2.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (2.3)
Requirement already satisfied: pathtools in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (0.1.2)
Requirement already satisfied: PyYAML in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (6.0)
Requirement already satisfied: sentry-sdk>=1.0.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (1.11.1)
Requirement already satisfied: docker-pycreds>=0.4.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (0.4.0)
Requirement already satisfied: GitPython>=1.0.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (3.1.29)
Requirement already satisfied: Click!=8.0.0,>=7.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (8.1.3)
Requirement already satisfied: setuptools in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (58.1.0)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.19.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (3.19.6)
Requirement already satisfied: setproctitle in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (1.3.2)
Requirement already satisfied: requests<3,>=2.0.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from wandb) (2.28.1)
Requirement already satisfied: colorama in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from Click!=8.0.0,>=7.0->wandb) (0.4.6)
Requirement already satisfied: six>=1.4.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from GitPython>=1.0.0->wandb) (4.0.10)
Requirement already satisfied: idna<4,>=2.5 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests<3,>=2.0.0->wandb) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests<3,>=2.0.0->wandb) (1.26.12)
Requirement already satisfied: charset-normalizer<3,>=2 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests<3,>=2.0.0->wandb) (2.1.1)
Requirement already satisfied: certifi>=2017.4.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests<3,>=2.0.0->wandb) (2022.9.24)
Requirement already satisfied: smmap<6,>=3.0.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from gitdb<5,>=4.0.1->GitPython>=1.0.0->wandb) (5.0.0)
Collecting evaluate
  Downloading evaluate-0.4.0-py3-none-any.whl (81 kB)
     ---------------------------------------- 81.4/81.4 kB 4.4 MB/s eta 0:00:00
Collecting multiprocess
  Downloading multiprocess-0.70.14-py39-none-any.whl (132 kB)
     ---------------------------------------- 132.9/132.9 kB ? eta 0:00:00
Requirement already satisfied: dill in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (0.3.1.1)
Collecting datasets>=2.0.0
  Downloading datasets-2.7.1-py3-none-any.whl (451 kB)
     -------------------------------------- 451.7/451.7 kB 7.1 MB/s eta 0:00:00
Requirement already satisfied: huggingface-hub>=0.7.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (0.11.1)
Requirement already satisfied: tqdm>=4.62.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (4.64.1)
Collecting fsspec[http]>=2021.05.0
  Downloading fsspec-2022.11.0-py3-none-any.whl (139 kB)
     -------------------------------------- 139.5/139.5 kB 4.2 MB/s eta 0:00:00
Requirement already satisfied: numpy>=1.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (1.23.5)
Requirement already satisfied: pandas in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (1.5.2)
Collecting xxhash
  Downloading xxhash-3.1.0-cp39-cp39-win_amd64.whl (30 kB)
Requirement already satisfied: packaging in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (21.3)
Requirement already satisfied: requests>=2.19.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from evaluate) (2.28.1)
Collecting responses<0.19
  Downloading responses-0.18.0-py3-none-any.whl (38 kB)
Collecting aiohttp
  Downloading aiohttp-3.8.3-cp39-cp39-win_amd64.whl (323 kB)
     -------------------------------------- 323.5/323.5 kB 6.7 MB/s eta 0:00:00
Requirement already satisfied: pyyaml>=5.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from datasets>=2.0.0->evaluate) (6.0)
Collecting pyarrow>=6.0.0
  Downloading pyarrow-10.0.1-cp39-cp39-win_amd64.whl (20.3 MB)
     --------------------------------------- 20.3/20.3 MB 11.3 MB/s eta 0:00:00
Requirement already satisfied: typing-extensions>=3.7.4.3 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from huggingface-hub>=0.7.0->evaluate) (4.4.0)
Requirement already satisfied: filelock in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from huggingface-hub>=0.7.0->evaluate) (3.8.0)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from packaging->evaluate) (3.0.9)
Requirement already satisfied: idna<4,>=2.5 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests>=2.19.0->evaluate) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests>=2.19.0->evaluate) (2022.9.24)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests>=2.19.0->evaluate) (1.26.12)
Requirement already satisfied: charset-normalizer<3,>=2 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from requests>=2.19.0->evaluate) (2.1.1)
Requirement already satisfied: colorama in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from tqdm>=4.62.1->evaluate) (0.4.6)
Collecting dill
  Downloading dill-0.3.6-py3-none-any.whl (110 kB)
     -------------------------------------- 110.5/110.5 kB 6.3 MB/s eta 0:00:00
Requirement already satisfied: python-dateutil>=2.8.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from pandas->evaluate) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from pandas->evaluate) (2022.6)
Collecting multidict<7.0,>=4.5
  Downloading multidict-6.0.3-cp39-cp39-win_amd64.whl (28 kB)
Collecting yarl<2.0,>=1.0
  Downloading yarl-1.8.2-cp39-cp39-win_amd64.whl (56 kB)
     ---------------------------------------- 56.8/56.8 kB ? eta 0:00:00
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from aiohttp->datasets>=2.0.0->evaluate) (4.0.2)
Requirement already satisfied: attrs>=17.3.0 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from aiohttp->datasets>=2.0.0->evaluate) (22.1.0)
Collecting frozenlist>=1.1.1
  Downloading frozenlist-1.3.3-cp39-cp39-win_amd64.whl (34 kB)
Collecting aiosignal>=1.1.2
  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)
Requirement already satisfied: six>=1.5 in c:\users\andre\appdata\local\programs\python\python39\lib\site-packages (from python-dateutil>=2.8.1->pandas->evaluate) (1.16.0)
Installing collected packages: xxhash, pyarrow, multidict, fsspec, frozenlist, dill, yarl, responses, multiprocess, aiosignal, aiohttp, datasets, evaluate
  Attempting uninstall: dill
    Found existing installation: dill 0.3.1.1
    Uninstalling dill-0.3.1.1:
      Successfully uninstalled dill-0.3.1.1
